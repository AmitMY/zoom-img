/*! Built with http://stenciljs.com */
const{h:t}=window.ImgZoom;class e{constructor(){this.src="",this.alt="",this.settings={step:.2,min:.125,max:1024,initial:1},this.rotation=0,this.boundMousemove=this.mousemove.bind(this),this.boundMouseup=this.mouseup.bind(this)}componentDidLoad(){this.reset(),this.img.addEventListener("wheel",this.onWheel.bind(this)),this.img.addEventListener("mousedown",this.mousedown.bind(this))}getRect(){return this.container.getBoundingClientRect()}getZoom(){return Number(this.img.style.zoom)}setZoom(t){this.img.style.zoom=String(Math.min(this.settings.max,Math.max(this.settings.min,t)))}zoom(t){this.setZoom(this.getZoom()*(1+this.settings.step*(t?1:-1)))}rotate(t){this.rotation+=90*(t?1:-1);const e=this.getOffset();this.setOffset(e[0],e[1])}getOffset(){const t=this.container.style.transform;if(t){const e=/translate\((.*?)px\,(.*?)px\) rotate\((.*?)deg\)/.exec(t);if(e&&4===e.length)return[e[1],e[2]].map(Number)}return[0,0]}setOffset(t,e){this.container.style.transform="translate("+t+"px,"+e+"px) rotate("+this.rotation+"deg)"}reset(){this.setZoom(this.settings.initial),this.rotation=0,this.setOffset(0,0),this.img.style.width=String(.9*this.host.getBoundingClientRect().width)+"px"}onWheel(t){t.preventDefault();const e=t.deltaY?t.deltaY:-t.wheelDelta,s=this.getRect(),i=(t.pageX-s.left-window.pageXOffset)/s.width,o=(t.pageY-s.top-window.pageYOffset)/s.height;if(i>1||i<0||o>1||o<0)return;this.zoom(e<0);const[n,r]=this.getOffset(),h=this.getRect(),a=t.pageX-h.left-window.pageXOffset+n,g=t.pageY-h.top-window.pageYOffset+r,m=a-h.width*i,u=g-h.height*o;this.setOffset(m,u)}mousedown(t){t.preventDefault(),this.previousEvent=t,window.addEventListener("mousemove",this.boundMousemove),window.addEventListener("mouseup",this.boundMouseup)}mouseup(t){t.preventDefault(),window.removeEventListener("mouseup",this.boundMouseup),window.removeEventListener("mousemove",this.boundMousemove)}mousemove(t){t.preventDefault();let[e,s]=this.getOffset();e+=t.pageX-this.previousEvent.pageX,s+=t.pageY-this.previousEvent.pageY,this.previousEvent=t,this.setOffset(e,s)}render(){return t("div",{ref:t=>this.container=t},t("img",{src:this.src,alt:this.alt,ref:t=>this.img=t}))}static get is(){return"img-zoom"}static get encapsulation(){return"shadow"}static get properties(){return{alt:{type:String,attr:"alt"},host:{elementRef:!0},settings:{type:"Any",attr:"settings"},src:{type:String,attr:"src"}}}static get style(){return":host{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;height:100%;width:100%}img{cursor:-webkit-grab}"}}export{e as ImgZoom};